import{a as K}from"./chunk-RQRBJOOX.js";import{a as q}from"./chunk-ICA7CC7K.js";import"./chunk-U2XBQLEQ.js";import{a as Z,c as J}from"./chunk-HW3JUR76.js";import{a as A,b as d,c as D,d as j,e as R,f as U,g as O,h as $,l as G,m as k,o as H}from"./chunk-B5U7MTIJ.js";import"./chunk-5L3H67GH.js";import"./chunk-KRFGI5I6.js";import{b as P,c as L,d as z}from"./chunk-FDIDMM2Q.js";import"./chunk-YOF75X22.js";import{Aa as I,Gb as a,Gc as M,Hb as o,Ib as u,Lc as B,Nb as S,Ob as g,Oc as N,Rb as b,Sb as w,Xb as l,Ya as r,Zb as s,a as _,aa as h,b as E,f as C,gc as p,hb as T,hc as m,mb as f,ua as F,xb as c,zb as v}from"./chunk-2JR2HJBW.js";function X(i,n){if(i&1&&(a(0,"div",23),l(1),o()),i&2){let t=g();r(),s(" ",t.getValidationMessage("name")," ")}}function Y(i,n){if(i&1&&(a(0,"div",23),l(1),o()),i&2){let t=g();r(),s(" ",t.getValidationMessage("email")," ")}}function ee(i,n){if(i&1&&(a(0,"div",23),l(1),o()),i&2){let t=g();r(),s(" ",t.getValidationMessage("phone")," ")}}function te(i,n){if(i&1&&(a(0,"div",23),l(1),o()),i&2){let t=g();r(),s(" ",t.getValidationMessage("address")," ")}}function re(i,n){if(i&1&&(a(0,"div",23),l(1),o()),i&2){let t=g();r(),s(" ",t.getValidationMessage("experience")," ")}}function ie(i,n){if(i&1&&(a(0,"div",23),l(1),o()),i&2){let t=g();r(),s(" ",t.getValidationMessage("current_salary")," ")}}function ne(i,n){if(i&1&&(a(0,"div",23),l(1),o()),i&2){let t=g();r(),s(" ",t.getValidationMessage("expected_salary")," ")}}function ae(i,n){if(i&1&&(a(0,"div",23),l(1),o()),i&2){let t=g();r(),s(" ",t.getValidationMessage("cover_letter")," ")}}function oe(i,n){if(i&1&&(a(0,"div",23),l(1),o()),i&2){let t=g();r(),s(" ",t.getFileValidationMessage()," ")}}function le(i){return n=>{if(!n.value||n.value==="")return null;let t=Number(n.value);return t>=i?null:{minSalary:{min:i,actual:t}}}}var Q=class i{jobTitle=F();formBuilder=h(k);careerService=h(K);translateService=h(P);toastr=h(J);platformId=h(I);current=h(q).getLanguage().subscribe(n=>{this.currentLang=n});currentLang="";selectedFile=null;fileValidationError=null;isSubmitting=!1;submitMessage="";contactForm=this.formBuilder.group({name:["",[d.required,d.minLength(3)]],email:["",[d.required,d.email,d.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]],phone:["",[d.required,d.minLength(10)]],address:["",[d.required,d.minLength(5)]],experience:["",[d.pattern(/^\d*$/)]],current_salary:["",[d.pattern(/^\d*$/)]],expected_salary:["",[d.required,d.pattern(/^\d+$/),le(1e3)]],cover_letter:[""]});ngOnInit(){}getValidationMessage(n){let t=this.contactForm.get(n);if(t&&t.errors&&t.touched){let e=t.errors;if(e.required)return this.translateService.instant(`submitForm.validation.${n}.required`);if(e.minSalary){let y=e.minSalary.min;return this.translateService.instant("contact.validation.expectedSalary.minSalary",{min:y})}if(e.email)return this.translateService.instant("contact.validation.email.invalid");if(e.fileSize)return this.translateService.instant("contact.validation.cvFile.fileSize");if(e.fileType)return this.translateService.instant("contact.validation.cvFile.fileType")}return null}hasValidationError(n){let t=this.contactForm.get(n);return!!(t&&t.errors&&t.touched)}hasFileValidationError(){return!!this.fileValidationError}getFileValidationMessage(){return this.fileValidationError==="required"?this.translateService.instant("submitForm.validation.cv_file.required"):this.fileValidationError==="fileSize"?this.translateService.instant("contact.validation.cvFile.fileSize"):this.fileValidationError==="fileType"?this.translateService.instant("contact.validation.cvFile.fileType"):null}onFileChange(n){let e=n.target.files?.[0];if(e){if(e.size>5*1024*1024){this.fileValidationError="fileSize",this.selectedFile=null;return}if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(e.type)){this.fileValidationError="fileType",this.selectedFile=null;return}this.selectedFile=e,this.fileValidationError=null}else this.selectedFile=null,this.fileValidationError="required"}onSubmit(){return C(this,null,function*(){if(this.selectedFile||(this.fileValidationError="required"),!this.contactForm.valid||!this.selectedFile||this.fileValidationError){Object.keys(this.contactForm.controls).forEach(e=>{this.contactForm.get(e)?.markAsTouched()});return}if(!N(this.platformId)){console.warn("reCAPTCHA can only be executed in browser environment");return}this.isSubmitting=!0,this.submitMessage="";let n=this.contactForm.getRawValue(),t=E(_({},n),{cv_file:this.selectedFile});this.careerService.submitApplication(t).subscribe({next:e=>{let y=decodeURIComponent(decodeURIComponent(this.jobTitle()||"")),x=E(_({},t),{jobTitle:y});this.careerService.sendEmail(x,x.cv_file).then(W=>{console.log("Email sent successfully",W)}),this.currentLang==="ar"?(this.toastr.success(e.ar_message,"Success"),this.submitMessage=e.ar_message):(this.toastr.success(e.en_message,"Success"),this.submitMessage=e.en_message),this.contactForm.reset(),this.selectedFile=null,this.fileValidationError=null;let V=document.getElementById("cvUpload");V&&(V.value="")},error:e=>{console.error("Form submission error:",e),this.submitMessage=this.translateService.instant("career.form.error"),this.currentLang==="ar"?this.toastr.error(e.ar_message||"\u062D\u062F\u062B \u062E\u0637\u0623","Error"):this.toastr.error(e.en_message||"An error occurred","Error")},complete:()=>{this.isSubmitting=!1}})})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=T({type:i,selectors:[["app-career-form"]],inputs:{jobTitle:[1,"jobTitle"]},decls:65,vars:84,consts:[[1,"flex","flex-wrap"],[1,"w-full","px-4"],[1,"bg-[#f7f7f7]","p-8","rounded-xl","overflow-hidden"],[1,"text-title-size","font-bold","text-primary","text-center","mt-2","mb-8"],[3,"ngSubmit","formGroup"],[1,"w-full","lg:w-1/2","px-4","mb-6"],[1,"form-group"],["type","text","formControlName","name","id","name",1,"w-full","px-4","py-3","border","rounded-md","focus:outline-none","focus:ring-2","focus:ring-default","focus:border-transparent",3,"placeholder"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["type","email","formControlName","email","id","email",1,"w-full","px-4","py-3","border","rounded-md","focus:outline-none","focus:ring-2","focus:ring-alternative","focus:border-transparent",3,"placeholder"],[1,"w-full","px-4","mb-6"],["type","text","formControlName","phone","id","phone",1,"w-full","px-4","py-3","border","rounded-md","focus:outline-none","focus:ring-2","focus:ring-alternative","focus:border-transparent",3,"placeholder"],["type","text","formControlName","address","id","address",1,"w-full","px-4","py-3","border","rounded-md","focus:outline-none","focus:ring-2","focus:ring-alternative","focus:border-transparent",3,"placeholder"],["type","number","formControlName","experience","id","experience","min","0",1,"w-full","px-4","py-3","border","rounded-md","focus:outline-none","focus:ring-2","focus:ring-alternative","focus:border-transparent",3,"placeholder"],["type","number","formControlName","current_salary","id","current_salary","min","0",1,"w-full","px-4","py-3","border","rounded-md","focus:outline-none","focus:ring-2","focus:ring-alternative","focus:border-transparent",3,"placeholder"],["type","number","formControlName","expected_salary","id","expected_salary","min","1000",1,"w-full","px-4","py-3","border","rounded-md","focus:outline-none","focus:ring-2","focus:ring-alternative","focus:border-transparent",3,"placeholder"],[1,"text-gray-500","text-sm","mt-1"],["formControlName","cover_letter","id","cover_letter","rows","4",1,"w-full","px-4","py-3","border","rounded-md","focus:outline-none","focus:ring-2","focus:ring-alternative","focus:border-transparent","resize-vertical",3,"placeholder"],["for","cvUpload",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","file","id","cvUpload","accept",".pdf,.doc,.docx",1,"w-full","px-4","py-3","border","rounded-md","focus:outline-none","focus:ring-2","focus:ring-alternative","focus:border-transparent","file:mr-4","file:py-2","file:px-4","file:rounded-md","file:border-0","file:text-sm","file:font-semibold","file:bg-alternative","file:text-white","hover:file:bg-primary",3,"change"],["type","submit",1,"default-btn","btn-bg-2","w-full","cursor-pointer","lg:w-auto","px-8","py-3","bg-primary","text-white","rounded-md","hover:bg-default","focus:outline-none","focus:ring-2","focus:ring-default","focus:ring-offset-2","transition","duration-200","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["id","msgSubmit",1,"text-title-size","text-center","hidden","mt-4"],[1,"clear-both"],[1,"text-red-500","text-sm","mt-1"]],template:function(t,e){t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),l(4),p(5,"translate"),o(),a(6,"form",4),S("ngSubmit",function(){return e.onSubmit()}),a(7,"div",0)(8,"div",5)(9,"div",6),u(10,"input",7),p(11,"translate"),f(12,X,2,1,"div",8),o()(),a(13,"div",5)(14,"div",6),u(15,"input",9),p(16,"translate"),f(17,Y,2,1,"div",8),o()(),a(18,"div",10)(19,"div",6),u(20,"input",11),p(21,"translate"),f(22,ee,2,1,"div",8),o()(),a(23,"div",10)(24,"div",6),u(25,"input",12),p(26,"translate"),f(27,te,2,1,"div",8),o()(),a(28,"div",5)(29,"div",6),u(30,"input",13),p(31,"translate"),f(32,re,2,1,"div",8),o()(),a(33,"div",5)(34,"div",6),u(35,"input",14),p(36,"translate"),f(37,ie,2,1,"div",8),o()(),a(38,"div",10)(39,"div",6),u(40,"input",15),p(41,"translate"),f(42,ne,2,1,"div",8),u(43,"p",16),o()(),a(44,"div",10)(45,"div",6),u(46,"textarea",17),p(47,"translate"),f(48,ae,2,1,"div",8),o()(),a(49,"div",10)(50,"div",6)(51,"label",18),l(52),p(53,"translate"),o(),a(54,"input",19),S("change",function(x){return e.onFileChange(x)}),o(),f(55,oe,2,1,"div",8),a(56,"p",16),l(57),p(58,"translate"),o()()(),a(59,"div",1)(60,"button",20),l(61),p(62,"translate"),o(),u(63,"div",21)(64,"div",22),o()()()()()()),t&2&&(r(4),s(" ",m(5,60,"Join-Darna")," "),r(2),c("formGroup",e.contactForm),r(4),v("border-red-500",e.hasValidationError("name"))("border-gray-300",!e.hasValidationError("name")),c("placeholder",m(11,62,"contact.form.name")),r(2),c("ngIf",e.hasValidationError("name")),r(3),v("border-red-500",e.hasValidationError("email"))("border-gray-300",!e.hasValidationError("email")),b("placeholder",m(16,64,"contact.form.email")),r(2),c("ngIf",e.hasValidationError("email")),r(3),v("border-red-500",e.hasValidationError("phone"))("border-gray-300",!e.hasValidationError("phone")),b("placeholder",m(21,66,"contact.form.phone")),r(2),c("ngIf",e.hasValidationError("phone")),r(3),v("border-red-500",e.hasValidationError("address"))("border-gray-300",!e.hasValidationError("address")),b("placeholder",m(26,68,"contact.form.address")),r(2),c("ngIf",e.hasValidationError("address")),r(3),v("border-red-500",e.hasValidationError("experience"))("border-gray-300",!e.hasValidationError("experience")),b("placeholder",m(31,70,"contact.form.experience")),r(2),c("ngIf",e.hasValidationError("experience")),r(3),v("border-red-500",e.hasValidationError("current_salary"))("border-gray-300",!e.hasValidationError("current_salary")),b("placeholder",m(36,72,"contact.form.currentSalary")),r(2),c("ngIf",e.hasValidationError("current_salary")),r(3),v("border-red-500",e.hasValidationError("expected_salary"))("border-gray-300",!e.hasValidationError("expected_salary")),w("placeholder","",m(41,74,"contact.form.expectedSalary")," *"),r(2),c("ngIf",e.hasValidationError("expected_salary")),r(4),v("border-red-500",e.hasValidationError("cover_letter"))("border-gray-300",!e.hasValidationError("cover_letter")),b("placeholder",m(47,76,"contact.form.coverLetter")),r(2),c("ngIf",e.hasValidationError("cover_letter")),r(4),s(" *",m(53,78,"contact.form.cvUpload")," "),r(2),v("border-red-500",e.hasFileValidationError())("border-gray-300",!e.hasFileValidationError()),r(),c("ngIf",e.hasFileValidationError()),r(2),s(" ",m(58,80,"contact.form.fileFormat")," "),r(3),c("disabled",e.contactForm.invalid),r(),s(" ",m(62,82,"Submit")," "))},dependencies:[H,R,A,U,D,j,G,O,$,z,L,B,M,Z],encapsulation:2})};export{Q as CarrerFormComponent};
